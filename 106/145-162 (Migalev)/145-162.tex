\documentclass{../../template/mai_book}

\defaultfontfeatures{Mapping=tex-text}
\setmainfont{DejaVuSerif}
\setdefaultlanguage{russian}

\begin{document}

\lhead{\small\textit{Решения упражнений}}
\rhead{145}

\noindent
[1, $n$] в [1, $n$], при этом коэффициент $\mu_\alpha$ определяется суммой

\begin{equation*}
\mu_{\alpha} = \sum_{\epsilon_i\in\{0,1\}} (-1)^{\epsilon_1+...+\epsilon_n} \epsilon_{\alpha(1)}...\epsilon_{\alpha(n)}.
\end{equation*}

\noindent
Если $\alpha$ — перестановка, коэффициент $\mu_\alpha$ равен $(—1)^n$, поскольку единственный ненулевой член суммы — это тот, для которого все $\epsilon_i$, равны 1. В противном случае можно разложить $\mu_\alpha$ следующим образом:

\begin{equation*}
\sum_{\epsilon_i, i \neq k} (-1)^{\epsilon_1+...+\epsilon_n} \sum_{\epsilon_k=0,1} (-1)^{\epsilon_k} \epsilon_{\alpha(1)}...\epsilon_{\alpha(n)},
\end{equation*}

\noindent
где $k$ — элемент из [1, $n$], который не принадлежит образу $\alpha$, и хорошо видно, что внутренний член (сумма по $\epsilon_k$) равен нулю; это доказывает, что $\mu_\alpha$ в этом случае равно нулю. Второе искомое выражение (суммы которого записываются на множествах) просто выводится из первого, исключением ненулевых $\epsilon_i$, появляющихся в сумме.

\subparagraph{b.} \textit{// here goes some text and code}

\setcounter{equation}{6}

\begin{equation}
{\sum}_{E'} = {\sum}_E + (-1)^{|E'|} \prod_{1 \leqslant i \leqslant n} S_i(E').
\end{equation}

\noindent
Вклад наименьшего элемента 0̸  в эту сумму — нулевой; значит, начнем с его последователя, который может быть \{1\}, \{$n$\} или какое-нибудь одноэлементное множество в соответствии с порядком, заданным на [1, $n$]. Можно заметить, что $S_i(E') = S_i(E) \pm a_{ij}$, где $\{j\} = E \triangle E'$.

\pagebreak

\lhead{146}
\rhead{\small\textit{$I$ \quad Алгоритмика и программирование на языке Ада}}

\noindent
В этой записи, как в алгоритме 12, $\pm$ должен пониматься как $+$, если $E \subset E'$ и $-$, если $E' \subset E$.

Чтобы оценить ${\sum}_{E'}$, исходя из ${\sum}_E$ с использованием 
соотношения (7), нужно осуществить $n$ сложений (для подсчета каждого $S_i (E')$), затем $n - 1$ перемножений: $S_1(E') \times \cdots \times S_n(E')$, и, наконец, 1 сложение. Имеем $2^n - 2$ операций для осуществления (7), при этом первый член $\sum = -{\prod}_{1 \leqslant i \leqslant n} \alpha_{in}$ требует $n - 1$ перемножений; это доказывает сформулированный результат о сложности. Сложность \textit{O}($n2^n$) значительна, но остается того же порядка, что и сложность, индуцированная определением ($n!(n - 1)$ перемножений и $n! - 1$ сложений). Формула Стирлинга позволяет сравнить эти два значения сложности: $ n \cdot n!/(n \cdot 2^n) \approx (n/2e)^n \sqrt{2\pi n}$.

\paragraph{22. Перманент матрицы (продолжение)}

\subparagraph{a.} Правая часть может рассматриваться как многочлен (от переменных $a_{ij}$), равный ${\sum}_\alpha \mu_\alpha a_{1 \alpha(1)} ... a_{n \alpha(n)}$, где сумма распространяется на все отображения [1, $n$] в [1, $n$]. Коэффициент $\mu_\alpha$ задан формулой

\begin{equation*}
\mu_\alpha = \sum_\omega \mu_\alpha(\omega) \quad \text{с} \quad \mu_\alpha(\omega) = \omega_1 \text{ ... } \omega_{n - 1} \omega_{\alpha(1)} \text{ ... } \omega_{\alpha(n)},
\end{equation*}

\noindent
в которой полагаем $\omega_n = 1$. Если $\alpha$ — перестановка, то каждое $\mu_\alpha(\omega)$, присутствующее в сумме $\mu_\alpha$, равно 1 и, следовательно, $\mu_\alpha = 2^{n - 1}$. Напротив, если $\alpha$ не является перестановкой, то сумма $\mu_\alpha$ — нулевая. Действительно, образ $\alpha$ отличен от [1, $n$], и различаем два случая: \newline
\indent ($i$) $\exists$ $k < n$, не принадлежащий образу $\alpha$, \newline
\indent ($ii$) $\exists$ $k < n$, дважды полученный из $\alpha$.

В обоих случаях члены $\mu_\alpha(\omega)$, присутствующие в сумме, группируются попарно, один соответствуя $\omega_k = 1$, другой — $\omega_k = -1$, и взаимно уничтожаются (в случае ($ii$) $\mu_\alpha(\omega) = \omega_k$).

\subparagraph{b.} Формула пункта \textbf{a} может быть записана в следующем виде:

\begin{equation*}
\frac{per A}{2} = \sum \omega_1 \text{ ... } \omega_{n - 1} \prod_{1 \leqslant i \leqslant n} (a_{in} + \omega_1 a_{i1} + \cdots + \omega_{n - 1} a_{in - 1})/2.
\end{equation*}

\noindent
Как и в предыдущем упражнении, вычисление перманента получается генерированием перебора при линейной упорядоченности на $\{-1, 1\}^{n - 1}$, в которой два последовательных элемента отличаются только одной компонентой. Если для $\omega \in \{-1, 1\}^{n - 1}$ и $i \leqslant n$ положить

\begin{equation*}
S_i(\omega) = (a_{in} + \omega_1 a_{i1} + \cdots + \omega_{n - 1} a_{in - 1})/2,
\end{equation*}

\pagebreak

\lhead{\small\textit{Решения упражнений}}
\rhead{147}

\noindent
то можно, благодаря перебору на $\{-1, 1\}^{n - 1}$, вычислить последовательно ${\sum}_\omega = {\sum}_{\rho \leqslant \omega}$... , используя формулу

\begin{equation}
	\begin{split}
	{\sum}_{\omega'} \quad = \quad &{\sum}_\omega + {\omega'}_1 \text{ ... } {\omega'}_{n - 1} \prod_{1 \leqslant i \leqslant n} S_i(\omega'),
	\\
	&\text{где } \omega' \text{ — последователь для } \omega \text{ в } \{-1, 1\}^{n - 1}.
	\end{split}
\end{equation}

\noindent
Если $j$ является индексом, по которому различаются два слова $\omega$ и $\omega'$, то сумма $S_i(\omega')$ вычисляется, исходя из $S_i(\omega)$, через $S_i(\omega') = S_i(\omega) - a_{ij}$, если $\omega_j = 1$, и через $S_i(\omega') = S_i(\omega) + a_{ij}$, если $\omega_j = -1$. \newline

\textit{// here goes some code}

\subparagraph{Алгоритм 13.} Вычисление перманента в кольце, где 2 обратимо \newline

С практической точки зрения для генерации адекватного перебора \linebreak $\{-1, 1\}^{n - 1}$, выбираем соответствие между $\{0, 1\}$ и $\{-1, 1\}$ вида $\epsilon \mapsto (-1)^\epsilon$ и классическую генерацию кода Грея на $\{0, 1\}^{n - 1}$, что достигается с помощью алгоритма 13. Мультипликативная сложность получается, если заметить, что нужно вычислить $2^n - 1$ членов ${\sum}_\omega$ , каждый из которых требует $n - 1$ перемножений (см. формулу (8)), значит, всего $2^{n - 1}(n - 1)$ произведений, к которым нужно добавить последнее умножение на 2. С точки зрения сложений первоначальный член ${\sum}_{(1,...,1)}$ требует $n(n - 1)$ сложений и $n$ делений на 2, тогда как общий член ${\sum}_\omega$ вычисляется, исходя из предыдущего, с помощью $n$ сложений; наконец, нужно сложить все эти члены, что требует в целом $n(n - 1) + (2^{n - 1} - 1)(n + 1)$ сложений и $n$ делений на 2. Заметим относительно предыдущего упражнения, что сложность была приблизительно разделена на 2.

\pagebreak

\lhead{148}
\rhead{\small\textit{$I$ \quad Алгоритмика и программирование на языке Ада}}

\subparagraph{c.} Рассмотрения полностью аналогичны предыдущему пункту, если
только невозможно деление на 2; деление (точное) на $2^{n - 1}$ будет иметь
место уже в конце. Результатом является алгоритм 14. \newline

\textit{// here goes some code}

\paragraph{23. Массив инверсий подстановки}

\subparagraph{d.} Массив инверсий перестановки $\alpha$ имеет вид (0, 0, 0, 1, 4, 2, 1, 5, 7). Свойство $0 \leqslant \alpha_k < k$ легко получается из того, что имеется точно $k - 1$ целых чисел, заключенных строго между 0 и $k$. Массив инверсий возрастающей перестановки интервала [1, $n$] есть, очевидно, (0, 0, ... , 0), и таблица для единственной убывающей перестановки —  (0, 1, 2, ... , n).

\subparagraph{e.} Можно использовать тот факт, что $a_{\alpha(j)}$ есть число индексов таких, что $i > j$ и $\alpha(i) < \alpha(j)$, что приводит к нижеследующему алгоритму: \newline

\textit{// here goes some code} \newline

Сложность полученного способа, конечно, имеет порядок квадрата длины перестановки.

\pagebreak

\lhead{\small\textit{Решения упражнений}}
\rhead{149}

\subparagraph{f.} Пусть $a$ — элемент из $[0, 1[ \times [0, 2[ \times \cdots \times [0, n[$. Построим перестановку $\alpha$, для которой $a$ является массивом инверсий, следующим способом: \newline

$\bullet$ элемент $n$ помещаем в массив, индексированный с помощью [1, $n$], представляющий $\alpha$, оставляя $a_n$ \textbf{пустых ячеек} справа от $n$; это означает в точности, что $\alpha^{-1}(n) = n - a_n + 1$;

$\bullet$ затем помещаем $n - 1$ в массив $\alpha$, оставляя $\alpha_{n - 1}$ \textbf{пустых ячеек} справа от $n - 1$;

$\bullet$ продолжаем, зная, что на $k$-м этапе этого процесса $k - 1$ величин уже размещены в массиве, следовательно, в массиве $\alpha$ остается $n - k$ свободных мест, и, с другой стороны, величина $\alpha_{n - k}$ строго меньше, чем $n - k$. \newline

\textit{// here goes some code} \newline

В алгоритме 15 использована оптимизация: свободные места в массиве, представляющем перестановку $\alpha$, отмечены числами 1, что позволяет не помещать это последнее значение в массив, представляющий $\alpha$, в конце алгоритма.

\paragraph{24. Перебор перестановок транспозициями $(i, i + 1)$}

\subparagraph{a.} Рассуждаем индукцией по $n$, при этом случаи $n = 1$ и $n = 2$ очевидны. С помощью перестановки $\sigma$ интервала [1, $n$] можно построить $n + 1$ перестановок $\sigma^1, \sigma^2, \text{ ... } , \sigma^{n + 1}$ интервала [1, $n + 1$], где перестановка $\sigma^i$ получается включением в $\sigma$ элемента $n + 1$ на $i$-ое место; например,

\pagebreak

\lhead{150}
\rhead{\small\textit{$I$ \quad Алгоритмика и программирование на языке Ада}}

\noindent
если $\sigma = (5 2 4 1 3)$, то

\begin{equation*}
	\begin{split}
	\sigma^1 &= \text{(\underline{6} 5 2 4 1 3)}, \quad \sigma^2 = \text{(5 \underline{6} 2 4 1 3), ... ,}
	\\
	&\sigma^5 = \text{(5 2 4 1 \underline{6} 3)}, \quad \sigma^6 = \text{(5 2 4 1 3 \underline{6})}.
	\end{split}
\end{equation*}

\noindent
Если $\sigma_1, \sigma_2, \text{ ... } , \sigma_{n!}$ и есть такая последовательность перестановок на [1, $n$], то соответствующую последовательность перестановок интервала [1, $n + 1$] получаем следующим образом:

\begin{equation*}
	\begin{split}
	&\sigma_1^1, \sigma_1^2, \text{ ... } , \sigma_1^{n + 1}, \quad \sigma_2^{n + 1}, \sigma_2^n, \text{ ... } , \sigma_2^1
	\\
	\sigma_3^1, &\sigma_3^2, \text{ ... } , \sigma_3^{n + 1}, \quad \sigma_4^{n + 1}, \sigma_4^n, \text{ ... }, \sigma_4^1 \quad \text{и т.д.}
	\end{split}
\end{equation*}

\subparagraph{b.} Действуем индукцией по $n$; знаем, что \textit{b} —  последующий элемент для $a$ в знакопеременном лексикографическом порядке —  получается изменением \textit{одной} компоненты $а$. Предположим сначала, что эта компонента — последняя; тогда имеем $b_n = a_n \pm 1$ и $b_j = a_j$ для $1 \leqslant j \leqslant n - 1$. Если $i$ — индекс $n$ в $\alpha$ (т.е. $\alpha(i) = n$), то имеем $\beta = \alpha \circ (i, i - 1)$ в случае $b_n = a_n + 1$, и $\beta = \alpha \circ (i, i + 1)$ в случае $b_n = a_n - 1$, при этом запись $(j, k)$ означает транспозицию индексов j и k.

Теперь предположим, что компонента, по которой различаются $a$ и $b$, не является последней. Поскольку $b$ — последующий элемент для $a$ в знакопеременном лексикографическом порядке, имеем $a_n = b_n = 0$ или $a_n = b_n = n$ и $b_{[1..n - 1]}$ есть последующий элемент для $a_{[1..n - 1]}$ в лексикографическом знакопеременном произведении $[0, 1[ \times [0, 2[ \times \cdots \times [0, n - 1[$, причем компонентой с самым большим индексом массива инверсий является та, которая меняется быстрее всех во время перебора в лексикографическом знакопеременном порядке. Если $\alpha'$ (соответственно, $\beta'$) означает перестановку [1, $n - 1$], для которой $a_{[1..n - 1]}$ (соответственно, $b_{[1..n - 1]}$) массив инверсий, то $\beta'$ получается из $\alpha'$ транспозицией двух последовательных элементов (гипотеза индукции). Тогда утверждение верно также и для $\alpha$ и $\beta$, поскольку элемент $n$ находится в этих перестановках либо на месте $n$ (случай $a_n = b_n = 0$), либо на месте 1 (случай $a_n = b_n = n$).

\subparagraph{c.} Пусть $\alpha$ — перестановка интервала [1, $n$] и $a = (a_1, a_2, \text{ ... }, a_n)$ — ее массив инверсий. По предыдущему сигнатура перестановки $\alpha$ является также сигнатурой $a$ в знакопеременном лексикографическом произведении. Алгоритм вычисления последующего элемента в знакопеременном лексикографическом произведении приводит к алгоритму 16-А.

В начале тела основного цикла этого алгоритма делается попытка опустить элемент $q$ (применить транспозицию ($\alpha^{-1}(q) - 1, a^{-1}(q)$) к перестановке $\alpha$) или же поднять его.

\pagebreak

\end{document} 
